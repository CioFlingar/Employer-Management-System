{% extends 'base.html' %}
{% block content %}
<div x-data="{ email: '', firstName: '', lastName: '', password: '', passwordConfirm: '', error: '' }" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center">
  <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md">
    <h2 class="text-2xl font-bold mb-4">Sign Up</h2>
    <p x-show="error" class="text-red-500 mb-4" x-text="error"></p>
    <form @submit.prevent="
      if (password !== passwordConfirm) {
        error = 'Passwords must match';
        return;
      }
      fetch('/api/auth/signup/', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email: email, first_name: firstName, last_name: lastName, password: password, password_confirm: passwordConfirm })
      })
      .then(response => response.json())
      .then(data => {
        if (data.user) {
          error = '';
          window.location.href = '/login/';
        } else {
          error = data.email?.[0] || data.password?.[0] || 'Signup failed';
        }
      })
      .catch(() => { error = 'Signup failed'; })
    " class="space-y-4">
      <input type="email" x-model="email" placeholder="Email" class="w-full p-2 border rounded" required>
      <input type="text" x-model="firstName" placeholder="First Name" class="w-full p-2 border rounded" required>
      <input type="text" x-model="lastName" placeholder="Last Name" class="w-full p-2 border rounded" required>
      <input type="password" x-model="password" placeholder="Password" class="w-full p-2 border rounded" required>
      <input type="password" x-model="passwordConfirm" placeholder="Confirm Password" class="w-full p-2 border rounded" required>
      <button type="submit" class="w-full bg-green-500 text-white p-2 rounded hover:bg-green-600">Sign Up</button>
    </form>
    <p class="mt-4 text-center">
      Already have an account? <a href="{% url 'login' %}" class="text-blue-500">Login</a>
    </p>
  </div>
</div>
{% endblock %}