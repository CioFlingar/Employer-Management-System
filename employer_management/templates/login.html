{% extends 'base.html' %}
{% block content %}
<div x-data="{ email: '', password: '', error: '' }" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center">
  <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md">
    <h2 class="text-2xl font-bold mb-4">Login</h2>
    <p x-show="error" class="text-red-500 mb-4" x-text="error"></p>
    <form @submit.prevent="
      fetch('/api/auth/login/', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email: email, password: password })
      })
      .then(response => response.json())
      .then(data => {
        if (data.access) {
          localStorage.setItem('accessToken', data.access);
          window.location.href = '/dashboard/';
        } else {
          error = data.error || 'Login failed';
        }
      })
      .catch(() => { error = 'Login failed'; })
    " class="space-y-4">
      <input type="email" x-model="email" placeholder="Email" class="w-full p-2 border rounded" required>
      <input type="password" x-model="password" placeholder="Password" class="w-full p-2 border rounded" required>
      <button type="submit" class="w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600">Login</button>
    </form>
    <p class="mt-4 text-center">
      No account? <a href="{% url 'signup' %}" class="text-blue-500">Sign up</a>
    </p>
  </div>
</div>
{% endblock %}